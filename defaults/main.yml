# TODO: Escaping double curly braces in Ansible https://stackoverflow.com/questions/32279519/escaping-double-curly-braces-in-ansible
 
B: "${HOME}/bin"
V: "${HOME}/dNull/ansible/group_vars/all/"
G: "${HOME}/dNull/ansible/group_vars"
T: "${HOME}/dNull/dotfiles/templates"
RT: "${HOME}/dNull/dotfiles/run_templates"
H: "${HOME}"
SU: "${HOME}/.config/systemd/user"
C: "${HOME}/.config/"
D: "${HOME}/dNull/"
 
templates:
  alacritty:
    template: "{{ T }}/alacritty.yml"
    config: "{{ C }}/alacritty/alacritty.yml"
    values: "{{ V }}/alacritty.yml"

tag: []
output: ""
# ROLE COMPONENT
role_component:
  # pip:
  #   virtualenv: ""
  backup: true
  render_dir: "{{ playbook_dir }}/component_rendered_tasks"
  yaml_with_includes: true
  force_restart:  false
  ignore_errors:  true
  user:   "{{ ansible_user }}"
  group:  "{{ ansible_user }}"
  mode:   644
  run:    systemd

  components:
    - alacritty


  alacritty:
    name: "Alacritty - GPU Terminal"
    install:
      npm: ""
      pre:
        - name: "[alacritty] deps"
          package:
            name: cargo
            state: present
          become: true
        # - name: "[alacritty] install dir"
        #   file:
        #     path: ~/install
        #     state: directory
        # - block:
        #   - name: "[alacritty] "
        #     package:
        #       name:
        #       - git
        #       - cargo
        #       - cmake
        #       - pkg-config
        #       - libfreetype6-dev
        #       - libfontconfig1-dev
        #       - libxcb-xfixes0-dev
        #       - libxkbcommon-dev
        #       - python3
        #     become: true
        #   - name: "[alacritty] repo"
        #     git:
        #      repo: "https://github.com/alacritty/alacritty.git"
        #      dest: ~/install/alacritty
        #      recursive: true
        #   - name: "[alacritty] cargo"
        #     shell: "cargo build --release"
        #     args:
        #       chdir: ~/install/alacritty
        #   - name: "[alacritty] install"
        #     shell: "sudo cp target/release/alacritty /usr/local/bin"
        #     args:
        #       chdir: ~/install/alacritty/
        #   when: ansible_facts['os_family'] == "Debian"
      post:
        - name: "[alacritty] cargo install"
          shell: cargo install alacritty
          # - name: "[alacritty] cp into /usr/bin/alacritty"
          #   # TODO: use ansible module instead
          #   # shell: sudo cp ~/.cargo/bin/alacritty /usr/bin/alacritty 
          #   # become: true
    configs:
      variables:
        font_size: 10.0
      templates:
        - alacritty
